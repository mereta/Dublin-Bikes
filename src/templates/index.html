<!DOCTYPE html>
    <html>
    <head>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>  
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

            {{sndmap.js}}
    </head>
    <body>
      <script type="text/javascript">
      
      google.charts.load('current', {'packages':['bar']});
      google.charts.setOnLoadCallback(drawChart);
      
		function runPyScript(location){
		var str = String(location)
        var jqXHR = $.ajax({
            type: "POST",
            url: "/getchartdata",
            async: false,
            data: { location: str }
        });

        return jqXHR.responseText;
        
        
    }
    
      function drawChart(location) {
      	var serverData = runPyScript(location)      	
		var data = new google.visualization.DataTable(JSON.parse(serverData));
    
        data.addColumn('string', 'Day');
        data.addColumn('number', 'Average');
        data.addRows(JSON.parse(serverData));
      	
      
          var options = {
          title: 'Weekly Dublin Bikes Occupancy',
          width: 900,
          height: 400,
          legend: { position: 'none' },
          chart: { subtitle: 'Average Percentage' },
          axes: {
            x: {
              0: { side: 'top', label: ('Weekday Average Percentage of Free Bikes in ' + location) } // Top x-axis.
            }
          },
          bar: { groupWidth: "90%" }
        };

        
		var chart = new google.charts.Bar(document.getElementById('barchart'));

        chart.draw(data, options);
      }
    </script>
        <h1>Current Dublin Bikes Occupancy per Station</h1>

        <h2>Dublin Bikes Map</h2>
        <h3> Click on Station for more info: 
        Percentage of bikes available: 
         0-25% Red, 26-50% Orange, 51-75% Yellow, 76-100% Green
        
        </h3>
	<div id=map>
        {{sndmap.html}}
       </div>
       
<div id="barchart">
	
</div>


    </body>
</html>